use strict;
use warnings;

use Test::More;

require "./0ch_delfc.pl";

{    # 安倍晋三テスト
    my $binary = pack( 'C*', 0x88, 0xc0, 0x94, 0x7b, 0x90, 0x57, 0x8e, 0x4f );
    my $res    = ZPL_delfc::replace_cmd $binary;
    is( $res, $binary, "Check: Abe Shinzo" );
}

{    # イングランド国旗
    my $binary = pack( 'C*',
        0x26, 0x23, 0x31, 0x32, 0x37, 0x39, 0x38, 0x38, 0x3b, 0x26, 0x23,
        0x39, 0x31, 0x37, 0x36, 0x30, 0x37, 0x3b, 0x26, 0x23, 0x39, 0x31,
        0x37, 0x36, 0x30, 0x32, 0x3b, 0x26, 0x23, 0x39, 0x31, 0x37, 0x36,
        0x30, 0x35, 0x3b, 0x26, 0x23, 0x39, 0x31, 0x37, 0x36, 0x31, 0x34,
        0x3b, 0x26, 0x23, 0x39, 0x31, 0x37, 0x36, 0x30, 0x37, 0x3b, 0x26,
        0x23, 0x39, 0x31, 0x37, 0x36, 0x33, 0x31, 0x3b );
    my $res = ZPL_delfc::replace_cmd $binary;
    is( $res, $binary, "Check: Flag of England" );
}

{    # ChMate イングランド国旗
    my $binary = pack( 'C*',
        0x26, 0x23, 0x31, 0x32, 0x37, 0x39, 0x38, 0x38, 0x3b, 0xfc, 0xfc,
        0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc, 0xfc );
    my $res = ZPL_delfc::replace_cmd $binary;
    is( $res, "&#127988;", "Check: Flag of England, ChMate" );
}

{    # 〝〟 (U+301F, U+301F)
    my $binary = pack( 'C*', 0x87, 0x80, 0x87, 0x81 );
    my $res    = ZPL_delfc::replace_cmd $binary;
    is( $res, $binary, "Check: Double Prime Quotation Mark" );
}

{    # U+FCFCに該当するアラビア文字
    my $binary = pack( 'C*', 0x26, 0x23, 0x36, 0x34, 0x37, 0x36, 0x34, 0x3b );
    my $res    = ZPL_delfc::replace_cmd $binary;
    is( $res, $binary, "Check: U+FCFC" );

}

{    # 任意回数の置換
    my $test_str = "ABE";
    my $binary   = pack( 'C*', 0xFC, 0xFC, 0xFC, 0xFC );
    my $res      = ZPL_delfc::replace_cmd $binary $test_str;
    is( $res, $test_str, "Check: replace_str" );
}

done_testing;

